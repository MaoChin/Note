# `RabbitMQ`初识

`RabbitMQ` 是一个实现了 `AMQP` 的 消息队列 服务，是当前主流的消息中间件之一。  

`AMQP: Advanced Message Queuing Protocol`(高级消息队列协议)  

`AMQP`的模型结构和下述的`RabbitMQ`的模型结构是一样的。  

#### 1. `MQ`的作用

1. **异步解耦**：在业务流程中，一些操作可能非常耗时，但并不需要即时返回结果。可以借助`MQ`把这些操作异步化。
2. **流量削峰填谷**：相当于一个蓄水池，当访问量突增时使用`MQ`来控制流量，将请求排队，系统根据自己的处理能力逐步处理这些请求；当访问量减少时可以处理`MQ`中暂存的请求。
3. **消息分发**：当多个系统需要对同一数据做出响应时，可以使用`MQ`进行消息分发，需要响应对应数据的系统进行订阅即可。
4. **延迟通知**：某些请求需要一段时间后进行处理，比如订单24h后未支付就取消，这是把请求放在`MQ`中进行延迟处理。  

#### 2. 一些常见的`MQ`产品

1. `Kafka`：追求高吞吐量，性能卓越，在日志领域比较成熟，功能较为简单，主要支持简单的`MQ`功能，如果有日志采集需求，首选`kafka`。  
2. `RocketMQ`：适用于可靠性比较高，且并发比较大的场景，比如互联网金融。但支持的客户端语言不多，且社区活跃度一般。
3. `RabbitMQ`：采用`Erlang`语言开发，`MQ`功能比较完备，几乎支持所有主流语言，开源提供的界面非常友好，但性能一般。

#### 3. `RabbitMQ`端口使用

1. 5672：客户端连接服务器的端口
2. 15672：`http`使用`GUI`访问的端口
3. 25672：`MQ`集群访问的端口

#### 3. `RabbitMQ`整体架构

![image-20241209104303884](E:\Note\RabbitMQ\RabbitMQ初识.assets\image-20241209104303884.png)    

1. `Connection`：客户端和`RabbitMQ`服务器之间的一个==TCP连接==。这个连接是建立消息传递的基础，它负责传输客户端和服务器之间的所有数据和控制信息。（生产者和消费者都可以认为是`RabbitMQ`的客户端）
2. `channel`：在`Connection`之上的一个抽象层，在`RabbitMQ`中，一个`TCP`连接可以
   有多个`Channel`，每个`Channel`都是独立的虚拟连接。消息的发送和接收都是基于`Channel`的，通道的主要作用是**将消息的读写操作复用到同一个`TCP`连接上**，这样可以减少建立和关闭连接的开销。  
3. `broker`：就是`RabbitMQ Server`。
4.   `Virtual Host`：类似`MySQL`的`database`，逻辑上的隔离，每个项目可以使用自己的`Virtual Host`。
5. `Exchange`：负责接收生产者发送的消息，并根据特定的规则把这些消息路由到一个或多个`Queue`中。`Exchange`起到了消息路由的作用，它根据类型和规则来确定如何转发接收到的消息。
6. `Queue`：存储具体消息的队列。  







 





