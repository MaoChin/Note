# 项目--网页视频播放器

总体模块划分：

![image-20231122191222082](E:\Note\项目\项目--网页视频播放器.assets\image-20231122191222082.png)

## 1. 环境搭建

需要的环境：`gcc 7`以上，`gdb`，`mysql`以及其他常用工具。

## 2. 第三方库介绍

需要安装的第三方库：`jsoncpp`，`httplib`

```shell 
# ubuntu下
sudo apt install libjsoncpp-dev
sudo apt install libcpp-httplib-dev
```

### 1. `json`介绍

一种常用的`key-value`数据传输格式，整体是一个字符串！主要分为对象，数组，字符串，数组四大类。

1. 对象：用 `{}`括起来的就是一个对象。
2. 数组：用 `[]` 括起来的就是一个数组。
3. 字符串：不多说。
4. 数字：分为整型和浮点型两类。

```json
// json格式示例
[
  {
    "姓名" : "小明",
    "年龄" : 18,
    "成绩" : [88.5, 99, 58]
  },
  {
    "姓名" : "小黑",
    "年龄" : 18,
    "成绩" : [88.5, 99, 58]
  }
]
```

`jsoncpp`就是用来进行`json`格式的序列化和反序列化的库。

一个关键类：`Json::Value`

```C++
//Json数据对象类
class Json::Value{
  //Value重载了[]和=，因此所有的赋值和获取数据都可以通过
  Value &operator=(const Value &other); 
  //简单的方式完成 val["姓名"] = "小明";
  Value& operator[](const std::string& key);
  Value& operator[](const char* key);
  Value removeMember(const char* key);  //移除元素
  const Value& operator[](ArrayIndex index) const; //val["成绩"][0]
  //添加数组元素val["成绩"].append(88);
  Value& append(const Value& value);
  //获取数组元素个数 val["成绩"].size();
  ArrayIndex size() const;
  //转string string name = 
  std::string asString() const;val["name"].asString();
  //转char* char *name = 
  const char* asCString() const;val["name"].asCString();
  //转int int age = val["age"].asInt();
  Int asInt() const;
  float asFloat() const;  //转float
  bool asBool() const;    //转 bool
};
```

序列化方法：`Value`对象 --> `json`串

```C++
//json序列化类，高版本推荐，如果用低版本的接口可能会有警告
// 抽象类
class JSON_API StreamWriter {
  // 纯虚函数
  virtual int write(Value const& root, std::ostream* sout) = 0;
}
class JSON_API StreamWriterBuilder : public StreamWriter::Factory {
  virtual StreamWriter* newStreamWriter() const;
}
```

反序列化方法： `json`串 --> `Value`对象

```C++
//json反序列化类，高版本更推荐
class JSON_API CharReader {
	virtual bool parse(char const* beginDoc, char const* endDoc,
  	Value* root, std::string* errs) = 0;
}
class JSON_API CharReaderBuilder : public CharReader::Factory {
  virtual CharReader* newCharReader() const;
}
```

`jsoncpp`的机制流程图：

![image-20231122213535640](E:\Note\项目\项目--网页视频播放器.assets\image-20231122213535640.png)

### 2. `httplib`介绍



### 3. `MySQL`的C语言接口库

下面是常用的几个接口函数：

```C
//Mysql操作句柄初始化
MYSQL *mysql_init(MYSQL *mysql)；
//参数为空则动态申请句柄空间进行初始化
//失败返回NULL
//连接mysql服务器
MYSQL *mysql_real_connect(MYSQL *mysql, const char *host, const char *user, const char *passwd,const char *db, unsigned int port,
const char *unix_socket, unsigned long client_flag);
//mysql--初始化完成的句柄
//host---连接的mysql服务器的地址
//user---连接的服务器的用户名
//passwd-连接的服务器的密码
//db ----默认选择的数据库名称
//port---连接的服务器的端口： 默认0是3306端口
//unix_socket---通信管道文件或者socket文件，通常置NULL
//client_flag---客户端标志位，通常置0
//返回值：成功返回句柄，失败返回NULL
//设置当前客户端的字符集
int mysql_set_character_set(MYSQL *mysql, const char *csname)
//mysql--初始化完成的句柄
//csname--字符集名称，通常："utf8"
//返回值：成功返回0， 失败返回非0；
//选择操作的数据库
int mysql_select_db(MYSQL *mysql, const char *db)
//mysql--初始化完成的句柄
//db-----要切换选择的数据库名称
//返回值：成功返回0， 失败返回非0；
//执行sql语句
int mysql_query(MYSQL *mysql, const char *stmt_str)
//mysql--初始化完成的句柄
//stmt_str--要执行的sql语句
//返回值：成功返回0， 失败返回非0；
//保存查询结果到本地
MYSQL_RES *mysql_store_result(MYSQL *mysql)
//mysql--初始化完成的句柄
//返回值：成功返回结果集的指针， 失败返回NULL；
//获取结果集中的行数与列数
uint64_t mysql_num_rows(MYSQL_RES *result)；
//result--保存到本地的结果集地址
//返回值：结果集中数据的条数；
unsigned int mysql_num_fields(MYSQL_RES *result)
//result--保存到本地的结果集地址
//返回值：结果集中每一条数据的列数；
//遍历结果集
MYSQL_ROW mysql_fetch_row(MYSQL_RES *result)
//result--保存到本地的结果集地址
//返回值：实际上是一个char **的指针，将每一条数据做成了字符串指针数组 row[0]-第0列 row[1]-第1列
//并且这个接口会保存当前读取结果位置，每次获取的都是下一条数据
//释放结果集
void mysql_free_result(MYSQL_RES *result)
//result--保存到本地的结果集地址
//返回值：void
//关闭数据库客户端连接，销毁句柄：
void mysql_close(MYSQL *mysql)
//获取mysql接口执行错误原因
const char *mysql_error(MYSQL *mysql)
```

`MySQL`操作基本流程：

1. 初始化`MySQL`操作句柄
2. 连接`MySQL`服务器
3. 设置字符集("UTF8")
4. 执行增删改查语句，其中增删改只需要执行成功即可，**查找语句需要将查找的结果保存到本地**，然后遍历打印结果，最后别忘了释放结果集。
5. 最后关闭连接，销毁句柄。

## 3. 服务端数据管理模块



## 4. 网络通信模块



## 5. 业务处理模块



## 6. 前端模块







